<div class="row">
  <div class="col-12">
    <app-card>
      <div class="consulta-header">
        <div>
          <p class="eyebrow">Consulta</p>
          <h4>Cuentas por Cobrar</h4>
          <p class="subtitle">Filtra por cliente, estado o rango de fechas y accede a opciones rapidas.</p>
        </div>
        <div class="header-stats">
          <div class="stat">
            <span class="stat-label">Registros</span>
            <strong class="stat-value">{{ filteredCuentas().length }}</strong>
          </div>
          <div class="stat">
            <span class="stat-label">Total filtrado</span>
            <strong class="stat-value">
              {{ getTotalFiltrado() | currency:'USD':'symbol':'1.0-0' }}
            </strong>
          </div>
        </div>
      </div>

      <div class="filters-grid">
        <div class="filter-group">
          <label>Cliente o referencia</label>
          <div class="input-icon">
            <i class="feather icon-search"></i>
            <input
              type="text"
              class="form-control"
              placeholder="Busca por nombre o referencia"
              [(ngModel)]="filtros.buscar"
              (ngModelChange)="resetPagina()">
          </div>
        </div>
        <div class="filter-group">
          <label>Estado</label>
          <select
            class="form-control"
            [(ngModel)]="filtros.estado"
            (ngModelChange)="resetPagina()">
            <option value="todos">Todos</option>
            <option value="pendiente">Pendiente</option>
            <option value="pagada">Pagada</option>
            <option value="vencida">Vencida</option>
          </select>
        </div>
        <div class="filter-group">
          <label>Desde</label>
          <input
            type="date"
            class="form-control"
            [(ngModel)]="filtros.desde"
            (change)="resetPagina()">
        </div>
        <div class="filter-group">
          <label>Hasta</label>
          <input
            type="date"
            class="form-control"
            [(ngModel)]="filtros.hasta"
            (change)="resetPagina()">
        </div>
        <div class="filter-actions">
          <button class="btn btn-light" type="button" (click)="resetFiltros()">
            <i class="feather icon-rotate-ccw"></i>
            Limpiar
          </button>
        </div>
      </div>

      <div class="table-wrapper">
        <div class="table-responsive">
          <table class="table table-striped table-hover consulta-table">
            <thead>
              <tr>
                <th>Cliente</th>
                <th>Monto</th>
                <th>Fecha</th>
                <th>Estado</th>
                <th class="text-right">Acciones</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let cuenta of pagedCuentas()">
                <td>
                  <div class="cliente-cell">
                    <span class="cliente-nombre">{{ cuenta.cliente }}</span>
                    <span class="cliente-referencia">Ref: {{ cuenta.fecha }}</span>
                  </div>
                </td>
                <td>
                  <span class="monto">{{ cuenta.monto | currency:'USD':'symbol':'1.0-0' }}</span>
                </td>
                <td>{{ cuenta.fecha | date:'yyyy-MM-dd' }}</td>
                <td>
                  <span class="estado-pill" [ngClass]="getEstadoClase(cuenta.estado)">
                    {{ cuenta.estado | titlecase }}
                  </span>
                </td>
                <td class="text-right">
                  <div class="row-actions">
                    <button class="btn btn-sm btn-outline-primary" type="button">
                      <i class="feather icon-eye"></i>
                    </button>
                    <button class="btn btn-sm btn-outline-secondary" type="button">
                      <i class="feather icon-send"></i>
                    </button>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div *ngIf="filteredCuentas().length === 0" class="empty-state">
          <i class="feather icon-inbox"></i>
          <p>Sin resultados para los filtros aplicados.</p>
        </div>
      </div>

      <div class="table-footer">
        <div class="page-size">
          <label>Mostrar</label>
          <select [ngModel]="pageSize" (ngModelChange)="onPageSizeChange($event)" class="form-control">
            <option *ngFor="let size of pageSizes" [value]="size">{{ size }}</option>
          </select>
          <span>por pagina</span>
        </div>

        <div class="pagination-controls">
          <button class="btn btn-light" type="button" (click)="changePage(-1)" [disabled]="page === 1">
            <i class="feather icon-chevron-left"></i>
          </button>
          <span>Pagina {{ page }} de {{ totalPaginas() }}</span>
          <button class="btn btn-light" type="button" (click)="changePage(1)" [disabled]="page === totalPaginas()">
            <i class="feather icon-chevron-right"></i>
          </button>
        </div>

        <div class="footer-actions">
          <button class="btn btn-outline-secondary" type="button" (click)="imprimir()">
            <i class="feather icon-printer"></i>
            Imprimir
          </button>
          <button class="btn btn-outline-primary" type="button" (click)="exportarExcel()">
            <i class="feather icon-download"></i>
            Exportar Excel
          </button>
        </div>
      </div>
    </app-card>
  </div>
</div>
